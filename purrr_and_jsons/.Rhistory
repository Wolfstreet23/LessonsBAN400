pull
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(location$coordinates$latLon$lat = map_chr(location$coordinates$latLon$lat, unlist_safe)
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, unlist_safe))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, 2, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = ""))
stations[[1]] %>%
map_df(~as_tibble(.)) %>%
head(1) %>%
select(location) %>%
pull
stations[[1]] %>%
map_df(~as_tibble(.)) %>%
head(1,2) %>%
select(location) %>%
pull
stations[[1]] %>%
map_df(~as_tibble(.)) %>%
head(1:100) %>%
select(location) %>%
pull
stations[[1]] %>%
map_df(~as_tibble(.)) %>%
head(1,2,3) %>%
select(location) %>%
pull
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
view(stations)
head(stations)
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, i, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, i, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, i, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, i, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, i, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, i, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 2, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 2, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1:4225, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1:4225, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1:4225, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df(~as_tibble(.)) %>%
head(3) %>%
select(location) %>%
pull
# a Europe/Berlin timezone on the variable:
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, x, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, x, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 50, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 50, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 0, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 0, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
# meets an entry that does not have aything stored under latestdata!
stations[[1]] %>%
map_df(~as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, unlist_safe)) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, unlist_safe))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, unlist_safe)) %>%
mutate(lon = map2_chr(location$coordinates$latLon$lon, unlist_safe))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map2_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, .x, .default = "")) %>%
mutate(lon = map2_chr(location$coordinates$latLon$lon, .x, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map2_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map2_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, .x, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, location$coordinates$latLon$lon 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map2_chr(location$coordinates$latLon$lat, 1, .default = ""))
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = ""))
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
?map_chr
source("C:/Users/EirikHjalte/iCloudDrive/Høst 2021/BAN400/Lessons/purrr_and_jsons/Purr and json structures.R")
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
print(stations)
print(stations[[1]])
print(stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = "")))
print(stations[[1]])
print(tbl_df(stations), n=40)
print(tibble(stations), n=40)
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, ., .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, ., .default = ""))
#The script should return a dataframe similar to the one below (only the first few entries shown).
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, ., .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, ., .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = walk(location$coordinates$latLon$lat, ., .default = "")) %>%
mutate(lon = walk(location$coordinates$latLon$lon, ., .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = walk2(location$coordinates$latLon$lat, ., .default = "")) %>%
mutate(lon = walk2(location$coordinates$latLon$lon, ., .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = walk2(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = walk2(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = walk2(location$coordinates$latLon$lat, ., .default = "")) %>%
mutate(lon = walk2(location$coordinates$latLon$lon, ., .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, ., .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, ., .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, ~., .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon ~., .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, ~. , .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon ~. , .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1,2, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1,2, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1:20, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1:20, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1,2,3,4, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1,2,3,4, .default = ""))
stations[[1]] %>%
map_df( ~ as_tibble(.)) %>%
mutate(latestData = map_chr(latestData, 1, .default = "")) %>%
mutate(latestData = as_datetime(latestData, tz = "Europe/Berlin")) %>%
mutate(hh = hour(latestData)) %>%
arrange(desc(hh)) %>%
mutate(lat = map_chr(location$coordinates$latLon$lat, 1, .default = "")) %>%
mutate(lon = map_chr(location$coordinates$latLon$lon, 1, .default = ""))
## ------
## ------    BAN400
## ------    LECTURE:       MACHINE LEARNING
## ------    DATA SOURCE:   https://www.kaggle.com/blastchar/telco-customer-churn
## ------
library(dplyr)
library(ggplot2)
library(tidymodels)      # <- This is new. Tidyverse take on modeling
no_color <- "#00000020"
yes_color <- "#FF000070"
pred_color <- c("#FFFFFF00", "#AA3333DD")
cutoff <- .5
grid_resolution <- 50
# Read the data
telco <-
readr::read_csv("telco-customer-churn/WA_Fn-UseC_-Telco-Customer-Churn.csv") %>%
select(Churn, MonthlyCharges, tenure) %>%
mutate(Churn = as.factor(Churn))
# Make a basic scatterplot
scatter <-
telco %>%
ggplot(aes(x = MonthlyCharges, y = tenure, colour = Churn)) +
geom_point() +
xlab("Monthly charges ($)") +
ylab("Tenure (months)") +
scale_color_manual(values=c(no_color, yes_color)) +
theme_classic()
